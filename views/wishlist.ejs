<%- include('./partials/header') %>

<div class="min-h-screen bg-gray-50 px-10 py-12">
  <h1 class="text-3xl font-semibold mb-8 text-gray-800">ðŸ’– Your Wishlist</h1>

  <% if (user.wishlist && user.wishlist.length > 0) { %>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
      <% user.wishlist.forEach(product => { %>
        <div class="bg-white shadow-md rounded-2xl overflow-hidden hover:shadow-lg transition">
          
          <!-- Product Image Section -->
          <div class="w-full h-64 flex items-center justify-center bg-[<%= product.bgcolor %>] overflow-hidden">
            <% if (product.image && Buffer.isBuffer(product.image)) { %>
              <img 
                class="h-full w-full object-contain p-4"
                src="data:image/jpeg;base64,<%= product.image.toString('base64') %>"
                alt="<%= product.name %>"
              >
            <% } else { %>
              <div class="text-gray-400 text-center">
                <i class="ri-image-line text-4xl"></i>
                <p class="mt-2">No Image</p>
              </div>
            <% } %>
          </div>

          <!-- Product Info -->
          <div class="p-4">
            <h2 class="text-lg font-semibold text-gray-800 truncate"><%= product.name %></h2>
            <p class="text-gray-600 mt-1">â‚¹<%= product.price %></p>

            <div class="mt-4 flex justify-between items-center">
              <!-- Remove Button -->
              <form action="/removewishlist/<%= product._id %>" method="POST">
                <button type="submit" class="text-red-500 hover:text-red-600 flex items-center gap-1">
                  <i class="ri-heart-fill text-lg"></i> Remove
                </button>
              </form>

              <!-- Add to Cart Button -->
              <form action="/addtocart/<%= product._id %>" method="POST">
                <button type="submit" class="bg-black text-white px-3 py-1 rounded-lg hover:bg-gray-800 text-sm">
                  Add to Cart
                </button>
              </form>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <div class="text-center mt-20">
      <h2 class="text-2xl text-gray-700 mb-4">Your wishlist is empty ðŸ’”</h2>
      <a href="/shop" class="inline-block bg-black text-white px-5 py-2 rounded-lg hover:bg-gray-800">
        Continue Shopping
      </a>
    </div>
  <% } %>
</div>

<%- include('./partials/footer') %>